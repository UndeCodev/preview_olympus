import{_ as ae,d as u,e as oe,f as re,a as le,g as o,h as t,s as J,k as p,x as k,w as c,v as C,n as y,i as n,F as $,j as _,J as V,t as d,q as N,A as ne,B as E,o as r,l as O}from"./index-CSTKgCyW.js";import{c as q,r as H,u as ie}from"./index-DIE5a-PX.js";import{r as de}from"./EyeIcon-CgvG_yKu.js";import{r as ue}from"./PencilSquareIcon-DdXct7zj.js";import{r as ce}from"./TrashIcon-DX2fkddC.js";const ve={key:0,class:"container mx-auto p-4"},pe={class:"flex justify-between items-center mb-4"},fe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},me={class:"bg-white rounded-lg shadow-lg p-6 overflow-y-auto max-md:w-2/3 w-1/3"},be={class:"mb-4"},ge={key:0},ye={class:"mb-4"},xe={key:0},we={class:"mb-4"},he=["min"],ke={key:0},$e={class:"bg-white rounded-lg shadow-lg max-sm:w-full mx-16 max-md:w-2/4 w-1/3 h-9/10 p-6 overflow-y-auto"},_e={class:"mb-4"},De={key:0},Ce={class:"mb-4"},Pe={key:0},Ve={class:"mb-4"},Me=["min"],Ee={key:0},Se={class:"mb-4"},ze={class:"flex items-center"},je={class:"bg-white rounded-lg shadow-xl w-full md:w-9/12 lg:w-1/2 max-h-[80vh] lg:h-max-2/3"},Ae={class:"p-6 space-y-6 h-full"},Fe={class:"text-3xl font-bold text-gray-800 border-b pb-2"},Ue={class:"space-y-4 grid place-content-between h-full grid-cols-1"},Te={class:"w-full"},Le={class:"text-gray-600 bg-gray-50 p-4 rounded-md"},Ne={class:"grid grid-cols-1 md:grid-cols-3 gap-4 pb-20"},Oe={class:"bg-blue-50 p-3 rounded-md"},qe={class:"text-lg text-blue-900"},He={class:"bg-green-50 p-3 rounded-md"},Be={class:"text-lg text-green-900"},Ie={class:"bg-purple-50 p-3 rounded-md"},Re={class:"text-lg text-purple-900"},Je={class:"flex justify-start items-center mb-4"},Xe={class:"flex items-center space-x-4"},Ye={class:"min-w-full bg-white border border-gray-200 shadow-md rounded-lg overflow-hidden"},Ge={key:0},Ke={class:"py-2 px-4 border-b border-gray-200"},Qe={class:"py-2 px-4 border-b border-gray-200 truncate max-w-xs"},We={class:"py-2 px-4 border-b border-gray-200 truncate max-w-xs"},Ze={class:"py-2 px-4 border-b border-gray-200 truncate max-w-xs"},et={class:"py-2 px-4 border-b border-gray-200"},tt={class:"py-2 px-4 border-b border-gray-200"},st={class:"py-2 px-4 border-b border-gray-200 max-w-xs"},at=["onClick"],ot=["onClick","disabled"],rt=["onClick","disabled"],lt={class:"text-4xl mt-12 text-center"},nt={key:1,class:"h-screen mt-32"},it={__name:"PrivacyPolicy",setup(dt){const S=u(!1),z=u(!1),f=u(null),D=u(!1),m=u(""),b=u(""),g=u(""),B=new Date().toISOString().split("T")[0],v=u(!1),M=u(!1),j=u(!1),x=u([]),X={title:{$autoDirty:!0,required:q.withMessage("Este campo es obligatorio",H)},content:{$autoDirty:!0,required:q.withMessage("Este campo es obligatorio",H)},effectiveDate:{$autoDirty:!0,required:q.withMessage("Este campo es obligatorio",H)}},P=oe.useToast(),l=ie(X,{title:m,content:b,effectiveDate:g}),w=u("all"),A=()=>{},I=re(()=>w.value==="all"?x.value:x.value.filter(a=>a.status===w.value)),F=()=>{S.value=!1,m.value="",b.value="",g.value="",l.value.$reset()},U=()=>{m.value="",b.value="",g.value="",z.value=!1,l.value.$reset()},Y=a=>{f.value=a,j.value=!0},R=()=>{j.value=!1,f.value=null},G=async a=>{try{if(!confirm("¿Estás seguro de que deseas eliminar esta política?"))return;v.value=!0;const s=await E.delete(`/dr/privacy-policy/${a}`,{status:"eliminada"});console.log("Política marcada como eliminada exitosamente:",s.data);const i=x.value.findIndex(h=>h.id===a);i!==-1&&(x.value[i].status="eliminada"),v.value=!1}catch(e){v.value=!1,console.error("Error al eliminar la política de privacidad:",e.message)}},K=async a=>{try{const{title:e,content:s,effectiveDate:i}=a;if(!e||!s||!i)throw new Error("Todos los campos son obligatorios.");const{data:h}=await E.post("/dr/privacy-policy",{title:e,content:s,effectiveDate:i});return h}catch(e){throw console.error("Error al crear la política de privacidad:",e.message),e}},Q=async()=>{if(l.value.$touch(),!l.value.$invalid)try{F(),v.value=!0;const a={title:m.value,content:b.value,effectiveDate:g.value},{message:e}=await K(a);await T(),v.value=!1,P.open({message:e,type:"success",duration:4e3,pauseOnHover:!0})}catch(a){v.value=!1;const e=a.response.data.message;P.open({message:e,type:"error",duration:4e3,pauseOnHover:!0})}},W=async(a,e)=>{try{const{title:s,content:i,effectiveDate:h,isCurrent:te}=e;if(!s||!i||!h||!a)throw new Error("Todos los campos son obligatorios.");const{data:se}=await E.put(`/dr/privacy-policy/${a}`,{title:s,content:i,effectiveDate:h,isCurrent:te});return se}catch(s){console.log(s);const i=s.response.data.message;P.open({message:i,type:"error",duration:4e3,pauseOnHover:!0})}},Z=async()=>{if(l.value.$touch(),!l.value.$invalid)try{v.value=!0;const a={title:m.value,content:b.value,effectiveDate:g.value,isCurrent:D.value==="true"},e=await W(f.value.id,a),s=x.value.findIndex(i=>i.id===f.value.id);s!==-1&&(x.value[s]=e.data),await T(),U(),P.open({message:e.message,type:"success",duration:4e3,pauseOnHover:!0}),v.value=!1}catch(a){v.value=!1;const e=a.response.data.message;P.open({message:e,type:"error",duration:4e3,pauseOnHover:!0})}},ee=a=>{f.value=a,m.value=a.title,b.value=a.content;const e=new Date(a.effectiveDate),s=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),h=String(e.getDate()).padStart(2,"0");g.value=`${s}-${i}-${h}`,D.value=a.status==="vigente",z.value=!0},T=async()=>{try{M.value=!0,x.value=[];const a=await E.get("/dr/privacy-policies");x.value=a.data,M.value=!1}catch(a){M.value=!1,console.error("Error al obtener las políticas de privacidad:",a)}},L=a=>{const e={year:"numeric",month:"long",day:"numeric"};return new Date(a).toLocaleDateString("es-MX",e)};return le(async()=>{await T()}),(a,e)=>M.value?(r(),o("div",nt,e[36]||(e[36]=[J('<div class="sk-chase w-24 h-24 mx-auto" data-v-55273183><div class="sk-chase-dot before:bg-slate-900" data-v-55273183></div><div class="sk-chase-dot before:bg-slate-900" data-v-55273183></div><div class="sk-chase-dot before:bg-slate-900" data-v-55273183></div><div class="sk-chase-dot before:bg-slate-900" data-v-55273183></div><div class="sk-chase-dot before:bg-slate-900" data-v-55273183></div><div class="sk-chase-dot before:bg-slate-900" data-v-55273183></div></div>',1)]))):(r(),o("div",ve,[t("div",pe,[e[12]||(e[12]=t("h1",{class:"text-2xl font-bold"},"Listado de Políticas de Privacidad",-1)),t("button",{onClick:e[0]||(e[0]=s=>S.value=!0),class:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700"}," + Agregar Política ")]),v.value?(r(),o("div",fe,e[13]||(e[13]=[J('<div class="sk-chase w-24 h-24" data-v-55273183><div class="sk-chase-dot" data-v-55273183></div><div class="sk-chase-dot" data-v-55273183></div><div class="sk-chase-dot" data-v-55273183></div><div class="sk-chase-dot" data-v-55273183></div><div class="sk-chase-dot" data-v-55273183></div><div class="sk-chase-dot" data-v-55273183></div></div>',1)]))):p("",!0),S.value?(r(),o("div",{key:1,onClick:k(F,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},[t("div",me,[e[18]||(e[18]=t("h2",{class:"text-2xl font-bold mb-4"},"Agregar Política de Privacidad",-1)),t("form",{onSubmit:k(Q,["prevent"])},[t("div",be,[e[14]||(e[14]=t("label",{for:"title",class:"block text-gray-700 font-medium"},"Título",-1)),c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),id:"title",type:"text",class:y([{"form-control--error":n(l).title.$error},"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-purple-600"])},null,2),[[C,m.value]]),n(l).title.$error?(r(),o("span",ge,[(r(!0),o($,null,_(n(l).title.$errors,s=>(r(),o("p",{key:s.$uid,class:"text-error"},d(s.$message),1))),128))])):p("",!0)]),t("div",ye,[e[15]||(e[15]=t("label",{for:"content",class:"block text-gray-700 font-medium"},"Contenido",-1)),c(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>b.value=s),id:"content",class:y(["w-full p-2 h-40 border rounded focus:outline-none focus:ring-2 focus:ring-purple-600 overflow-y-scroll resize-none",{"form-control--error":n(l).content.$error}])},null,2),[[C,b.value]]),n(l).content.$error?(r(),o("span",xe,[(r(!0),o($,null,_(n(l).content.$errors,s=>(r(),o("p",{key:s.$uid,class:"text-error"},d(s.$message),1))),128))])):p("",!0)]),t("div",we,[e[16]||(e[16]=t("label",{for:"effectiveDate",class:"block text-gray-700 font-medium"},"Fecha de Vigencia",-1)),c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),min:n(B),id:"effectiveDate",type:"date",class:y(["w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-purple-600",{"form-control--error":n(l).effectiveDate.$error}])},null,10,he),[[C,g.value]]),n(l).effectiveDate.$error?(r(),o("span",ke,[(r(!0),o($,null,_(n(l).effectiveDate.$errors,s=>(r(),o("p",{key:s.$uid,class:"text-error"},d(s.$message),1))),128))])):p("",!0)]),t("div",{class:"flex justify-between items-center"},[t("button",{type:"button",onClick:F,class:"text-red-600 hover:text-red-800"}," Cancelar "),e[17]||(e[17]=t("button",{type:"submit",class:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700"}," Crear política de privacidad ",-1))])],32)])])):p("",!0),z.value?(r(),o("div",{key:2,onClick:k(U,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},[t("div",$e,[e[26]||(e[26]=t("h2",{class:"text-2xl font-bold mb-4"},"Editar Política de Privacidad",-1)),t("form",{onSubmit:k(Z,["prevent"])},[t("div",_e,[e[19]||(e[19]=t("label",{for:"title",class:"block text-gray-700 font-medium"},"Título",-1)),c(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),id:"title",type:"text",class:y(["w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-purple-600",{"form-control--error":n(l).title.$error}])},null,2),[[C,m.value]]),n(l).title.$error?(r(),o("span",De,[(r(!0),o($,null,_(n(l).title.$errors,s=>(r(),o("p",{key:s.$uid,class:"text-error"},d(s.$message),1))),128))])):p("",!0)]),t("div",Ce,[e[20]||(e[20]=t("label",{for:"content",class:"block text-gray-700 font-medium"},"Contenido",-1)),c(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>b.value=s),id:"content",class:y(["w-full p-2 h-40 border rounded focus:outline-none focus:ring-2 focus:ring-purple-600 overflow-y-scroll resize-none",{"form-control--error":n(l).content.$error}])},null,2),[[C,b.value]]),n(l).content.$error?(r(),o("span",Pe,[(r(!0),o($,null,_(n(l).content.$errors,s=>(r(),o("p",{key:s.$uid,class:"text-error"},d(s.$message),1))),128))])):p("",!0)]),t("div",Ve,[e[21]||(e[21]=t("label",{for:"effectiveDate",class:"block text-gray-700 font-medium"},"Fecha de Vigencia",-1)),c(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>g.value=s),min:n(B),id:"effectiveDate",type:"date",class:y(["w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-purple-600",{"form-control--error":n(l).effectiveDate.$error}])},null,10,Me),[[C,g.value]]),n(l).effectiveDate.$error?(r(),o("span",Ee,[(r(!0),o($,null,_(n(l).effectiveDate.$errors,s=>(r(),o("p",{key:s.$uid,class:"text-error"},d(s.$message),1))),128))])):p("",!0)]),t("div",Se,[e[24]||(e[24]=t("label",{class:"block text-gray-700 font-medium"},"¿Esta versión es vigente?",-1)),t("div",ze,[c(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>D.value=s),type:"radio",value:"true",id:"current-yes",class:"mr-2"},null,512),[[V,D.value]]),e[22]||(e[22]=t("label",{for:"current-yes",class:"mr-4"},"Sí",-1)),c(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>D.value=s),type:"radio",value:"false",id:"current-no",class:"mr-2"},null,512),[[V,D.value]]),e[23]||(e[23]=t("label",{for:"current-no"},"No",-1))])]),t("div",{class:"flex justify-between items-center"},[t("button",{type:"button",onClick:U,class:"text-red-600 hover:text-red-800"}," Cancelar "),e[25]||(e[25]=t("button",{type:"submit",class:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700"}," Actualizar Política ",-1))])],32)])])):p("",!0),j.value?(r(),o("div",{key:3,onClick:k(R,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},[t("div",je,[t("div",Ae,[t("h2",Fe,d(f.value.title),1),t("div",Ue,[t("div",Te,[e[27]||(e[27]=t("h3",{class:"text-lg font-semibold text-gray-700 mb-2"},"Contenido:",-1)),t("p",Le,d(f.value.content),1)]),t("div",Ne,[t("div",Oe,[e[28]||(e[28]=t("p",{class:"text-sm font-medium text-blue-800"},"Fecha de Vigencia",-1)),t("p",qe,d(L(f.value.effectiveDate)),1)]),t("div",He,[e[29]||(e[29]=t("p",{class:"text-sm font-medium text-green-800"},"Fecha de Creación",-1)),t("p",Be,d(L(f.value.createdAt)),1)]),t("div",Ie,[e[30]||(e[30]=t("p",{class:"text-sm font-medium text-purple-800"},"Última Actualización",-1)),t("p",Re,d(L(f.value.updatedAt)),1)])])])]),t("div",{class:"bg-gray-50 flex justify-end p-4"},[t("button",{onClick:R,class:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition duration-200 ease-in-out transform hover:scale-105"}," Cerrar ")])])])):p("",!0),t("div",Je,[e[34]||(e[34]=t("label",{class:"mr-4 text-gray-700 font-medium"},"Filtrar por estado:",-1)),t("div",Xe,[t("label",null,[c(t("input",{type:"radio",value:"all","onUpdate:modelValue":e[9]||(e[9]=s=>w.value=s),onChange:A},null,544),[[V,w.value]]),e[31]||(e[31]=N(" Todos "))]),t("label",null,[c(t("input",{type:"radio",value:"no vigente","onUpdate:modelValue":e[10]||(e[10]=s=>w.value=s),onChange:A},null,544),[[V,w.value]]),e[32]||(e[32]=N(" No vigente "))]),t("label",null,[c(t("input",{type:"radio",value:"eliminada","onUpdate:modelValue":e[11]||(e[11]=s=>w.value=s),onChange:A},null,544),[[V,w.value]]),e[33]||(e[33]=N(" Eliminada "))])])]),t("table",Ye,[e[35]||(e[35]=t("thead",null,[t("tr",{class:"bg-gray-100 text-left"},[t("th",{class:"py-2 px-4 border-b border-gray-200"},"Fecha de Creación"),t("th",{class:"py-2 px-4 border-b border-gray-200"},"Versión"),t("th",{class:"py-2 px-4 border-b border-gray-200"},"Título"),t("th",{class:"py-2 px-4 border-b border-gray-200"},"Contenido"),t("th",{class:"py-2 px-4 border-b border-gray-200"},"Estado"),t("th",{class:"py-2 px-4 border-b border-gray-200"},"Fecha de vigencia"),t("th",{class:"py-2 px-4 border-b border-gray-200"},"Acciones")])],-1)),I.value.length>0&&!v.value?(r(),o("tbody",Ge,[(r(!0),o($,null,_(I.value,s=>(r(),o("tr",{key:s.id,class:y(["hover:bg-gray-50",s.status==="vigente"?"bg-gray-200":""])},[t("td",Ke,d(new Date(s.createdAt).toLocaleDateString()),1),t("td",Qe,d(s.version),1),t("td",We,d(s.title),1),t("td",Ze,d(s.content),1),t("td",et,[t("span",{class:y([{"bg-green text-green-600":s.status==="vigente","text-yellow-600":s.status==="no vigente","text-red-600":s.status==="eliminada"},"capitalize"])},d(s.status),3)]),t("td",tt,d(new Date(s.effectiveDate).toLocaleDateString()),1),t("td",st,[t("button",{onClick:i=>Y(s),class:"text-slate-600 hover:text-slate-800 mr-2"},[O(n(de),{class:"size-8"})],8,at),t("button",{onClick:k(i=>ee(s),["prevent"]),class:y(["text-blue-600 hover:text-blue-800 mr-2",{"opacity-50 cursor-not-allowed":s.status==="eliminada"}]),disabled:s.status==="eliminada"},[O(n(ue),{class:"size-8"})],10,ot),t("button",{onClick:k(i=>G(s.id),["prevent"]),class:y(["text-red-600 hover:text-red-800",{"opacity-50 cursor-not-allowed":s.status==="eliminada"}]),disabled:s.status==="eliminada"},[O(n(ce),{class:"size-8"})],10,rt)])],2))),128))])):p("",!0)]),c(t("h1",lt," Aún no hay registros de políticas de privacidad, agrega uno para empezar a listar. ",512),[[ne,x.value.length===0]])]))}},mt=ae(it,[["__scopeId","data-v-55273183"]]);export{mt as default};
