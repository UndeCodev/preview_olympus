import{o as l,c as r,h as a,e as u,g,l as d,k as V,a as _,i as h,F,j as q,q as w,A as x,w as K,v as S,N as B,O as I}from"./index-qKey4Usj.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";function P(f,c){return l(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M14 8a.75.75 0 0 1-.75.75H4.56l3.22 3.22a.75.75 0 1 1-1.06 1.06l-4.5-4.5a.75.75 0 0 1 0-1.06l4.5-4.5a.75.75 0 0 1 1.06 1.06L4.56 7.25h8.69A.75.75 0 0 1 14 8Z","clip-rule":"evenodd"})])}function L(f,c){return l(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M2 8a.75.75 0 0 1 .75-.75h8.69L8.22 4.03a.75.75 0 0 1 1.06-1.06l4.5 4.5a.75.75 0 0 1 0 1.06l-4.5 4.5a.75.75 0 0 1-1.06-1.06l3.22-3.22H2.75A.75.75 0 0 1 2 8Z","clip-rule":"evenodd"})])}const E={key:0,class:"mfa"},R=["src"],Z={key:1,class:"bg-white rounded-md shadow-sm p-8 grid place-items-center gap-12"},$={class:"flex space-x-5"},Q=["onUpdate:modelValue","onInput","onKeydown"],T={class:"flex gap-6"},U={__name:"MFAView",setup(f){const c=u(""),m=u("KVKFKRCPNZQUYMLXOVYDSQKJKZDTSRLD"),p=u(!1),s=u(["","","","","",""]),y=I(),v=g(()=>y.query.email),b=g(()=>s.value.join(""));console.log(v.value);const A=async()=>{try{const e=await x.post("/auth/mfa/setup",{email:v.value});c.value=e.data.qrCode,m.value=e.data.secret}catch(e){console.error("Error configurando MFA:",e)}},C=async()=>{try{const e=await x.post("/auth/mfa/verify",{token:b.value,secret:m.value});console.log(e)}catch{alert("Código MFA inválido")}};A();const k=(e,t)=>{t.target.value.length===1&&e<s.value.length-1&&document.querySelectorAll("input")[e+1].focus()},M=e=>{s.value[e]===""&&e>0&&document.querySelectorAll("input")[e-1].focus()},D=e=>{const i=e.clipboardData.getData("text").split("").slice(0,6);i.forEach((n,o)=>{s.value[o]=n||""}),document.querySelectorAll("input")[i.length-1].focus(),e.preventDefault()};return(e,t)=>p.value?(l(),r("form",Z,[t[6]||(t[6]=a("div",{class:"grid gap-3"},[a("h1",{class:"mfa__title text-5xl text-center font-bold"},"Confirma el Código de Autenticación"),a("h2",{class:"mfa__subtitle text-center"}," Introduce el código de 6 dígitos generado en la app de autenticación. ")],-1)),a("div",$,[(l(!0),r(F,null,q(s.value,(i,n)=>K((l(),r("input",{key:n,type:"text",class:"border rounded text-center w-10",maxlength:"1","onUpdate:modelValue":o=>s.value[n]=o,onInput:o=>k(n,o),onPaste:t[1]||(t[1]=o=>D(o)),onKeydown:B(o=>M(n),["backspace"])},null,40,Q)),[[S,s.value[n]]])),128))]),a("div",T,[a("button",{class:"btn btn-outline flex place-content-center place-items-center gap-2",onClick:t[2]||(t[2]=w(i=>p.value=!1,["prevent"]))},[_(h(P),{class:"size-7"}),t[5]||(t[5]=d("Paso anterior "))]),a("button",{class:"btn btn-primary flex place-content-center place-items-center",onClick:w(C,["prevent"])}," Completar verificación de 2 pasos ")])])):(l(),r("div",E,[t[4]||(t[4]=a("div",{class:"mfa__information"},[a("h1",{class:"mfa__title text-5xl text-center mb-4 font-bold"}," Protege tu cuenta con la verificación en dos pasos "),a("h2",{class:"mfa__subtitle text-center"},[d(" 1. Abre tu aplicación de autenticación (Google Authenticator, Authy, etc.). "),a("br"),d(" 2. Selecciona la opción para escanear un código QR. ")])],-1)),c.value?(l(),r("img",{key:0,src:c.value,alt:"Escanea este código con Google Authenticator",class:"mfa__qr shadow-sm rounded-sm"},null,8,R)):V("",!0),a("button",{class:"btn btn-primary w-2/3 flex place-content-center place-items-center gap-2",onClick:t[0]||(t[0]=i=>p.value=!0)},[t[3]||(t[3]=d(" Continuar ")),_(h(L),{class:"size-7"})])]))}},G=N(U,[["__scopeId","data-v-641245c7"]]);export{G as default};
